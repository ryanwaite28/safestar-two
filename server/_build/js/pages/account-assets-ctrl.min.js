"use strict";$(document).ready(function(){var t=$("#new_user_asset_name"),o=$("#user_assets_count"),s=$("#user_assets_list"),n=$("#first_name_span"),a=$("#middle_name_span"),u=$("#last_name_span"),i={},e=[client.check_session(),client.get_user_assets(),client.get_user_assets_count()];Promise.all(e).then(function(e){var t=e[0];if(n.text(tools.capitalize(t.user.fname)),a.text(tools.capitalize(t.user.mname)),u.text(tools.capitalize(t.user.lname)),tools.array_sort_by(e[1].user_assets,"id","desc").forEach(function(e){i[e.unique_value]=e,s.append($(e.dom))}),o.text(e[2].count),0===e[2].count)return $("a#load-more-btn").remove();console.log(e,i)}).catch(function(e){console.log("error",e)}),$(document).on("click","a#submit_new_user_asset_btn",function(){var e=t.val();tools.setActionButtonsDisabledState(!0),client.add_user_asset({asset_name:e}).then(function(e){console.log(e),tools.setActionButtonsDisabledState(!1),window.M.toast({html:e.message}),e.error||(i[e.new_user_asset.unique_value]=e.new_user_asset,s.prepend($(e.new_user_asset.dom)),t.val(""),o.text(Object.keys(i).length))})}),$(document).on("click","a.edit_user_asset_btn",function(e){var t=$(this).data("user_asset_unique_value");$("#edit_user_asset_box_"+t).toggleClass("ghost-1")}),$(document).on("click","a.delete_user_asset_btn",function(e){var s=$(this).data("user_asset_unique_value"),t=i[s];t&&window.confirm('Are you sure you want to delete "'+t.name+'"?')&&(tools.setActionButtonsDisabledState(!0),client.delete_user_asset({asset_id:t.id}).then(function(e){if(console.log(e),tools.setActionButtonsDisabledState(!1),window.M.toast({html:e.message}),!e.error){var t=$("#user_asset_"+s);$(t).remove(),delete i[s],o.text(Object.keys(i).length)}}))}),$(document).on("click","a.submit_edits_user_asset_btn",function(e){var n=$(this).data("user_asset_unique_value"),t=i[n];if(t){var s="#edit_user_asset_value_input_"+n,a=$("#edit_user_asset_name_input_"+n).val();$(s).val(),tools.setActionButtonsDisabledState(!0),client.edit_user_asset({asset_name:a,asset_id:t.id}).then(function(e){if(console.log(e),tools.setActionButtonsDisabledState(!1),window.M.toast({html:e.message}),!e.error){var t=$("#user_asset_"+n),s=$(e.user_asset.dom);t.replaceWith(s),i[n]=e.user_asset,o.text(Object.keys(i).length)}})}}),$(document).on("click","a#load-more-btn",function(){var e=Object.keys(i).map(function(e){return i[e].id}).reduce(function(e,t){return Math.min(e,t)});client.get_user_assets(e).then(function(e){if(0===e.user_assets.length)return $("a#load-more-btn").remove();tools.array_sort_by(e.user_assets,"id","desc").forEach(function(e){i[e.unique_value]=e,s.append($(e.dom))})})})});