"use strict";$(document).ready(function(){var e=$("#new_user_entity_name"),o=$("#user_entities_count"),n=$("#user_entities_list"),i=$("#first_name_span"),s=$("#middle_name_span"),_=$("#last_name_span"),a={},t=[client.check_session(),client.get_user_entities()];Promise.all(t).then(function(t){var e=t[0];i.text(tools.capitalize(e.user.fname)),s.text(tools.capitalize(e.user.mname)),_.text(tools.capitalize(e.user.lname)),tools.array_sort_by(t[1].user_entities,"id","desc").forEach(function(t){a[t.unique_value]=t,n.append($(t.dom))}),o.text(Object.keys(a).length),console.log(t,a)}).catch(function(t){console.log("error",t)}),$(document).on("click","a#submit_new_user_entity_btn",function(){var t=e.val();tools.setActionButtonsDisabledState(!0),client.add_user_entity({entity_name:t}).then(function(t){console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),t.error||(a[t.new_user_entity.unique_value]=t.new_user_entity,n.prepend($(t.new_user_entity.dom)),e.val(""),o.text(Object.keys(a).length))})}),$(document).on("click","a.edit_user_entity_btn",function(t){var e=$(this).data("user_entity_unique_value");$("#edit_user_entity_box_"+e).toggleClass("ghost-1")}),$(document).on("click","a.delete_user_entity_btn",function(t){var n=$(this).data("user_entity_unique_value"),e=a[n];e&&window.confirm('Are you sure you want to delete "'+e.name+'"?')&&(tools.setActionButtonsDisabledState(!0),client.delete_user_entity({entity_id:e.id}).then(function(t){if(console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),!t.error){var e=$("#user_entity_"+n);$(e).remove(),delete a[n],o.text(Object.keys(a).length)}}))}),$(document).on("click","a.submit_edits_user_entity_btn",function(t){var i=$(this).data("user_entity_unique_value"),e=a[i];if(e){var n="#edit_user_entity_value_input_"+i,s=$("#edit_user_entity_name_input_"+i).val();$(n).val(),tools.setActionButtonsDisabledState(!0),client.edit_user_entity({entity_name:s,entity_id:e.id}).then(function(t){if(console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),!t.error){var e=$("#user_entity_"+i),n=$(t.user_entity.dom);e.replaceWith(n),a[i]=t.user_entity,o.text(Object.keys(a).length)}})}})});