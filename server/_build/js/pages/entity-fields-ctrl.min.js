"use strict";$(document).ready(function(){var e,i,t=location.pathname.split("/"),n=t[t.length-1],l=$("#new_entity_field_name"),o=$("#new_entity_field_value"),_=$("#entity_fields_count"),d=$("#entity_fields_list"),a=$("#entity_name_heading"),s={};client.check_session().then(function(t){return e=t,client.get_user_entity(n)}).then(function(t){return i=t.user_entity,a.text(i.name),client.get_entity_fields(i.id)}).then(function(t){console.log(e,i,t),tools.array_sort_by(t.entity_fields,"id","desc").forEach(function(t){s[t.unique_value]=t,d.append($(t.dom))}),_.text(Object.keys(s).length)}).catch(function(t){console.log("error",t)}),$(document).on("click","a#submit_new_entity_field_btn",function(){var t=l.val(),e=o.val();tools.setActionButtonsDisabledState(!0),client.add_entity_field({entity_field_name:t,entity_field_value:e,entity_id:i.id}).then(function(t){console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),t.error||(s[t.new_entity_field.unique_value]=t.new_entity_field,d.prepend($(t.new_entity_field.dom)),l.val(""),o.val(""),_.text(Object.keys(s).length))})}),$(document).on("click","a.edit_entity_field_btn",function(t){var e=$(this).data("entity_field_unique_value");$("#edit_entity_field_box_"+e).toggleClass("ghost-1")}),$(document).on("click","a.delete_entity_field_btn",function(t){var i=$(this).data("entity_field_unique_value"),e=s[i];e&&window.confirm('Are you sure you want to delete "'+e.name+'"?')&&(tools.setActionButtonsDisabledState(!0),client.delete_entity_field({entity_field_id:e.id}).then(function(t){if(console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),!t.error){var e=$("#entity_field_"+i);$(e).remove(),delete s[i],_.text(Object.keys(s).length)}}))}),$(document).on("click","a.submit_edits_entity_field_btn",function(t){var n=$(this).data("entity_field_unique_value"),e=s[n];if(e){var i="#edit_entity_field_value_input_"+n,l=$("#edit_entity_field_name_input_"+n).val(),o=$(i).val();tools.setActionButtonsDisabledState(!0),client.edit_entity_field({entity_field_name:l,entity_field_value:o,entity_field_id:e.id}).then(function(t){if(console.log(t),tools.setActionButtonsDisabledState(!1),window.M.toast({html:t.message}),!t.error){var e=$("#entity_field_"+n),i=$(t.entity_field.dom);e.replaceWith(i),s[n]=t.entity_field,_.text(Object.keys(s).length)}})}})});